<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢–∏—Ö–∞—è –ø–æ–º–æ—â—å</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>

<body>

<header class="header">
  <div class="logo">ü§ç –¢–∏—Ö–∞—è –ø–æ–º–æ—â—å</div>
</header>

<section class="hero">
  <h1>–¢—ã –Ω–µ –æ–±—è–∑–∞–Ω —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –æ–¥–∏–Ω</h1>
  <p>–°–ø–æ–∫–æ–π–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä. –ê–Ω–æ–Ω–∏–º–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞.</p>
  <button onclick="scrollToChat()">–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä</button>
</section>

<section id="chat-section" class="chat-wrapper">
  <div class="chat-card">

    <div class="chat-header">
      –û–Ω–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∞
      <span class="status-dot"></span>
    </div>

    <div id="chatBox" class="chat"></div>

    <div id="typing" class="typing">–ë–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç...</div>

    <div class="input-area">
      <input id="message"
             placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
             onkeydown="if(event.key==='Enter'){sendMessage();}">
      <button onclick="sendMessage()">‚û§</button>
    </div>

  </div>
</section>

<script>
const socket = io();
const chat = document.getElementById("chatBox");
const typing = document.getElementById("typing");

function scrollToChat(){
  document.getElementById("chat-section")
  .scrollIntoView({behavior:'smooth'});
}

function addMsg(text, cls){
  const div=document.createElement("div");
  div.className="msg "+cls;
  div.textContent=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function sendMessage(){
  const input=document.getElementById("message");
  const msg=input.value.trim();
  if(!msg) return;

  addMsg(msg,"user");
  input.value="";
  typing.style.display="block";
  socket.emit("message",{msg:msg});
}

socket.on("response",function(data){
  typing.style.display="none";
  addMsg(data.msg,"bot");
});
</script>

</body>
</html>
